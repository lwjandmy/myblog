

<html><head><meta charset="UTF-8"><title>列表解析 生成器
</title><meta name="viewport" content="width=device-width, initial-scala=1.0"></head><body><div id="markdown">






<h1 id="-">列表解析 生成器</h1>
<p>#-<em>- coding: UTF-8 -</em>-</p>
<h1 id="-list-comprehensions-">列表解析(List comprehensions)，用来动态创建列表</h1>
<h1 id="-">语法:</h1>
<h1 id="-expr-for-iter_var-in-iterable-">[expr for iter_var in iterable]</h1>
<p>[x ** 2 for x in range(6)]</p>
<h1 id="output-0-1-4-9-16-25-">OUTPUT: [0, 1, 4, 9, 16, 25]</h1>
<h1 id="-if-">结合if：</h1>
<h1 id="-expr-for-iter_var-in-iterable-if-cond_expr-">[expr for iter_var in iterable if cond_expr]</h1>
<p>[row[1] for row in M if row[1]%2==0]
[(x+1, y+1) for x in range(3) for y in range(5)]</p>
<p>M=[[1,2,3],[4,5,6],[7,8,9]]
[row[1] for row in M]    output:[2,5,8]
[row[1] for row in M if row[1]%2==0]    output: [2,8]
[M[i][i] for i in [0,1,2]]   output: [1,5,9]
[c*2 for c in &#39;spam&#39;]  output:  [&#39;ss&#39;,&#39;pp&#39;,&#39;aa&#39;,&#39;mm&#39;]</p>
<h1 id="-">生成器表达式:</h1>
<h1 id="-expr-for-iter_var-in-iterable-if-cond_expr-">(expr for iter_var in iterable if cond_expr]</h1>
<h1 id="-generator-object-next-">返回一个generator object, 有next()方法，</h1>
<h1 id="-next-stopiteration-">到达最后一个，next()抛出StopIteration异常</h1>
<h1 id="-">测试生成器的确是延时求值</h1>
<p>lst = [1, 2, 3]</p>
<p>def deal_with_x(x):
    print(&#39;deal with x: &#39; + str(x))
    return x</p>
<p>normal = [deal_with_x(x) for x in lst]
lazy = (deal_with_x(x) for x in lst)
print(&#39;call lazy.next: &#39; + str(lazy.next()))
print(&#39;call lazy.next: &#39; + str(lazy.next()))
print(&#39;call lazy.next: &#39; + str(lazy.next()))</p>
<h1 id="-">读取文件每行，忽略井号开头行，并去掉行尾空白符</h1>
<p>lines=[line.rstrip() for line in open(&#39;script1.py&#39;) if line[0]!=&#39;#&#39;]</p>
<h1 id="-for">多个for</h1>
<p>[x+y for x in &#39;ab&#39; for y in &#39;123&#39;]   output: [&#39;a1&#39;,&#39;a2&#39;,&#39;a3&#39;,&#39;b1&#39;,&#39;b2&#39;,&#39;b3&#39;]</p>
<h1 id="-">等价于</h1>
<p>for x:
    for y:
        x+y</p>
<h1 id="-">迭代工具:</h1>
<p>map(abs, [-1,1])                 # output: [1,1]  对列表各项应用一个函数，结果收集到新列表。类似列表解析
sorted([3,1,2])                  # output: [1,2,3] 对列表迭代各项，排序
zip([1,2,3],[7,8,9])             # output: [(1,7),(2,8),(3,9)]    迭代列表各项，组合
enumerate([5,6,7])               # output: [(0,5),(1,6),(2,7)]  根据下标，用元组配对下标和值
filter(check, [0,1,2])           # 筛选函数调用返回真的项
reduce(operator.add,[1,2,3,4])   # output: 10  对迭代项成对调用函数</p>
<p>list(open(&#39;script1.py&#39;))         # 读取文件到列表
tuple(open(&#39;script1.py&#39;))        # 读取文件到元组
&#39;&amp;&amp;&#39;.join(open(&#39;script1.py&#39;))    # 读取文件，用&amp;&amp;连接每行</p>
<p>set(open(&#39;script1.py&#39;))          # 读取文件到集合
{line for line in open(&#39;script1.py&#39;)}      # 读取文件到字典
{ix: line for ix, line in enumerate(open(&#39;script1.py&#39;))}  # 读取文件,用enumerate产生序号,并放到字典</p>


</div>
<script src="../js/jquery-1.12.3.min.js" charset="utf-8"></script>
<link rel="stylesheet" href="../css/highlight.min.css">
<script src="../js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
jQuery(function ($) {
});
</script></body></html>

