# archlinux安装


## 准备磁盘

```bash
fdisk -l # 查看磁盘空间等

cfdisk # 分配分区

mkfs -t ext4 /mnt # 格式化分区

mount /dev/sda1 /mnt # 挂载分区
```

## 准备安装源安装系统

```bash
vim /etc/pacman.d/mirrorlist # 编辑镜像, 把中国的镜像放在前面

pacstrap /mnt # 安装arch

cp /etc/pacman.d/mirrorlist /mnt/etc/pacman.d/mirrorlist # 镜像放到安装的系统里一份

arch-chroot /mnt # 切换到系统
```

## 配置网络

```bash
sudo systemctl enable dhcpcd # 开启dhcpcd客户端
sudo systemctl start dhcpcd
vi /etc/resolv.conf # 配置dns地址 8.8.8.8
```

## 系统基础软件安装

```bash
pacman -S grub sudo vim samba git npm # 安装基础软件
```

## 配置grub

```bash
grub-install /mnt/sda # 安装grub引导

grub-mkconfig > /boot/grub/grub.cfg # 生成grub配置
```

## 配置sudo

```bash
visudo -f /etc/sudoer # 配置sudo用户组

groupadd sudo # 添加sudo用户组
```

## 配置用户

```bash
useradd li # 添加用户

passwd li # 配置用户密码

usermod li -G sudo # 配置用户属sudo用户组

mkdir -p /home/li # 建立用户目录

cp /etc/skel/.bash_profile /home/li # 初始化用户bash配置
```

## 配置vim

```bash
cp /usr/share/vim/vim80/vimrc_example.vim ~/.vimrc

vim ~/.vimrc # 末尾添加set mouse=c, 在xshell中方便复制粘贴文字

sudo cp ~/.vimrc /root # vim配置给root一份, sudo vim时会用
```

## 配置语言

```bash
vim /etc/locale.gen # 配置zh_CN.UTF-8 UTF-8

sudo locale-gen

vim ~/.bash_profile # 末尾加declare -x LANG=zh_CN.UTF-8
```

## 配置samba

```bash
sudo systemctl enable smbd # 开启启动samba服务

sudo cp /etc/samba/smb.conf.default /etc/samba/smb.conf # 使用默认smb配置

sudo vim /etc/samba/smb.conf # 在comment = Home Directories配置处, 最后添加path = /, 让路径转到根路径

sudo smbpasswd -a li # 添加samba用户, 及配置用户密码

sudo systemctl start smbd # 启动samba服务
```


